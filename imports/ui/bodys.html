
<template name='bodys'>

<div id="modalwarning" class="modal" >
    <div class="modal-content">
      <h3 class="flashit center">ALERTA</h3>      
    </div>
  </div>

  <!--a id="menuxxx" class="waves-effect waves-light btn btn-floating" ><i class="material-icons">menu</i></a>

  < Tap Target Structure >
  <div class="tap-target" data-target="menuxxx">
    <div class="tap-target-content">
      <h5>Title</h5>
      <p>A bunch of text</p>
    </div>
  </div-->

<body>
  
    <script>
      /* JS comes here */
      askForApproval();
      
            function askForApproval() {
                if(Notification.permission === "granted") {
                    
                }
                else {
                    Notification.requestPermission(permission => {
                        if(permission === 'granted') {
                            createNotification('Necesitamos permisos para notificarte!', 'created by @Domus', 'https://www.studytonight.com/css/resource.v2/icons/studytonight/st-icon-dark.png');
                        }
                    });
                }
            }
            
            function createNotification(title, text, icon) {
                const noti = new Notification(title, {
                    body: text,
                    icon
                });
            }


    </script>




  <!--nav class="light-blue lighten-1">
    <div class="nav-wrapper">
      <a href="#!" class="brand-logo">Domus <i class="material-icons">blur_on</i></a>
      <a href="#" data-target="mobile-demo" class="sidenav-trigger right"><i class="material-icons">menu</i></a>
      <ul class="right hide-on-med-and-down">
         {{#if currentUser}}
            <li><a href="/">Controles</a></li>
            {{#if admin currentUser._id}}
            <li><a href="/config" id="configuracion">Configuración</a></li>
            {{/if}}
        {{/if}}
         <li><a href="#"> {{> loginButtons}}</a></li>
      </ul>
    </div>
  </nav-->


  <nav class="lighten-1 light-blue">
    <div class="nav-wrappera">
      <a href="#!" class="brand-logo">Domus <i class="material-icons">blur_on</i></a>
       <a href="#" data-activates="slide-out" class="button-collapse hide-on-large-only"><i class="material-icons">menu</i></a>
         <ul  class="right hide-on-med-and-down">
          {{#if currentUser}}
            <li><a href="/">Controles</a></li>
            {{#if admin currentUser._id}}
            <li><a href="#!" class="icono_seguridad waves-effect waves-light pulse"><i class="material-icons" id="icono_seguridad_w">{{#if equals programas.estado "on" }}lock{{else}}lock_open{{/if}}</i></a></li>
            <li><a href="/general">General</a></li>
            <li><a href="/config" id="configuracion">Configuración</a></li>

            {{/if}}
        {{/if}}
         <li><a href="#"> {{> loginButtons align="right"}}</a></li>
       </ul>
     
       
      
    </div>

  </nav>
 
 <ul id="slide-out" class="side-nav show-on-small">
          {{#if currentUser}}
            <li><a href="/">Controles <i class="material-icons">apps</i></a></li>
            {{#if admin currentUser._id}}
            <li><a href="#!" class="icono_seguridad">{{#if equals programas.estado "on" }}Seguridad activa{{else}}Seguridad Desactivada{{/if}}<i class="material-icons" id="icono_seguridad_m">{{#if equals programas.estado "on" }}lock{{else}}lock_open{{/if}}</i></a></li>
            <li><a href="/general">General <i class="material-icons">multiline_chart</i></a></li>
            <li><a href="/config" id="configuracion">Configuración <i class="material-icons">settings</i></a></li>
            {{/if}}

     
         
        {{/if}}
         {{> login}}
       </ul>
 


    
<script type="text/javascript">
  $(".button-collapse").sideNav();
   $('.datepicker').datepicker({container: 'body'});
        $('.timepicker').timepicker();
</script>







  <!--nav class="light-blue lighten-1" role="navigation">
    <div class="nav-wrapper container">
      <a id="logo-container" href="#" class="brand-logo"></a>
      <ul class="right hide-on-med-and-down">
        <li><a href="#"> </a></li>
      </ul>

      <ul id="nav-mobile" class="sidenav">
        
        {{#if currentUser}}
            <li><a href="/">Controles</a></li>
            {{#if admin currentUser._id}}
            <li><a href="/config" id="configuracion">Configuración</a></li>
            {{/if}}
        {{/if}}
         <li><a href="#"> {{> loginButtons}}</a></li>
      </ul>
      <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>

     
    </div>
  </nav-->
  <div class="section no-pad-bot" id="index-banner">


{{#if currentUser}}
  	{{> Template.dynamic template=index}}
  {{else}}
    <div class="container">
  <img class="materialboxed center" width="100%" src="/images/iot.png">
  </div>
  {{/if}}

  <footer class="page-footer orange">
    <div class="container">
      <div class="row">
        <div class="col s12">
          <p class="white-text">Universidad Central de Venezuela</p>
          <p class="white-text">Facultad de Ciencias</p>
          <p class="white-text">Escuela de Computación</p>
          <p class="grey-text text-lighten-4">Sistema Domótico como TEG de la Escuela de Computación de Facultad de Ciencias - UCV</p>


        </div>
        <!--div class="col l3 s12">
          <h5 class="white-text dropdown-trigger"  data-target='dropdown1'>Settings</h5>
          <ul id='dropdown1' class='dropdown-content'>
            <li><a class="white-text" href="#!">Link 1</a></li>
            <li><a class="white-text" href="#!">Link 2</a></li>
            <li><a class="white-text" href="#!">Link 3</a></li>
            <li><a class="white-text" href="#!">Link 4</a></li>
          </ul>
        </div>
        <div class="col l3 s12">
          <h5 class="white-text dropdown-trigger" href='#' data-target='dropdown2'>Connect</h5>
          <ul id='dropdown2' class='dropdown-content'>
            <li><a class="white-text" href="#!">Link 1</a></li>
            <li><a class="white-text" href="#!">Link 2</a></li>
            <li><a class="white-text" href="#!">Link 3</a></li>
            <li><a class="white-text" href="#!">Link 4</a></li>
          </ul>
        </div-->
      </div>
    </div>
    <div class="footer-copyright">
      <div class="container">
      Made with <a class="orange-text text-lighten-3" href="http://materializecss.com">Materialize</a>
      </div>
    </div>
  </footer>
</div>

  <!--  Scripts-->


  </body> 
    

  </template>

  <template name="login">
                  {{#if currentUser}}
                  <div class="divider"></div>
                  <li><a href="#" class="logout">Cerrar Sesión <i class="material-icons">power_settings_new</i></a></li>
                     
                    {{else}}
                      <form class="login-form center">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <h3>Iniciar Sesión</h3>
                            </div>
                            <div class="panel-body">
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email"  class="form-control" id="email" placeholder="Email address">
                                </div>
                                <div class="form-group">
                                    <label>Contraseña</label>
                                    <input type="password" class="form-control" id="password" placeholder="password">
                                </div>
                            </div>
                            <div class="panel-footer">
                                <button type="submit" class="btn btn-danger btn-lg">Iniciar sesión</button>
                            </div>
                        </div>
                    </form>
                    {{/if}}

                  

  </template>





<template name='principal'>

  <style type="text/css">
    
    .blink {
      animation: blink 2s steps(5, start) infinite;
      -webkit-animation: blink 1s steps(5, start) infinite;
    }
    @keyframes blink {
      to {
        visibility: hidden;
      }
    }
    @-webkit-keyframes blink {
      to {
        visibility: hidden;
      }
    }
  </style>


  <div class="row">
      <div class="col s12 m2">
        


        <ul id="nav-mobile" class="sidenav sidenav-fixed" style="transform: translateX(0px);">
      
        <li class="no-padding">
          <ul class="collapsible collapsible-accordion">
            
            {{#each zonas}}

                <li class="bold zona" ><a class="collapsible-header waves-effect waves-teal truncate" tabindex="0" data-zona="{{_id}}">{{_id}}<i id="fuego_{{_id}}" class="big material-icons right fuego_icon" style="display: none; color:red">whatshot</i></a>
                </li>

            {{/each}}


           
           
            
           
          </ul>
        </li>
       
      </ul>





      </div>
      <div class="col s12 m10">
        
          

  <div class="container">
    <div class="section">

      <!--   Icon Section   ->
      <div class="row"-->
       
       {{#each dispositivos}}
       
             {{#if equals tipo "actuador"}}

  <!-- actuador -->
   <div class="col s12 m4">
          <div class="icon-block">
            <h2 class="center light-blue-text"><i class="medium material-icons">{{icono}}</i></h2>
            <h5 class="center">{{nombre}} {{#if equals especifico "air"}} {{tempactual}} °C {{/if}}</h5>
                <div class="switch center">
                  <label>
                    Off
                    {{# if equals estado "off"}}
                    <input type="checkbox" data-id={{pin}} data-zona={{zona}} class="switch" data-especifico={{especifico}} >
                    {{else}}
                    <input type="checkbox" data-id={{pin}} data-zona={{zona}}  checked class="switch" data-especifico={{especifico}}>
                    {{/if}}
                    <span class="lever"></span>
                    On
                  </label>
                  <br>
                  <br>
                  {{# if equals especifico "air"}}
                  <a class="btn-floating btn-small waves-effect waves-light light-blue"><i class="material-icons cambiar" data-id="{{_id}}" data-accion="bajar">remove</i></a>
                    <a class="btn-floating btn-small waves-effect waves-light light-blue" ><i class="material-icons cambiar" data-id="{{_id}}" data-accion="subir">add</i></a>
                    

                    {{else}}

                    <a class="btn-flat btn-small white"><i class="material-icons"></i></a>
                    <a class="btn-flat btn-small white"><i class="material-icons"></i></a>

                    {{/if}}
                </div>
            
          </div>
        </div>

  <!-- sensor -->
{{else}}
   <div class="col s12 m4">
          <div class="icon-block">
            <h2 class="center light-blue-text"><i class=" medium material-icons" id="icono_{{_id}}">{{icono}}</i></h2>
            <h5 class="center">{{nombre}} </h5>
            <h5 class="center">  {{# if equals especifico "ldr"}}
                                        {{# if equals valor "LOW.OSCURO"}} 
                                            Muy oscuro 
                                        {{/if}}
                                        {{# if equals valor "HIGH.OSCURO"}} 
                                            Oscuro
                                        {{/if}}
                                        {{# if equals valor "LOW.LUZ"}} 
                                            Claro 
                                        {{/if}} 
                                        {{# if equals valor "HIGH.LUZ"}} 
                                            Muy claro
                                        {{/if}}      
                                  {{else}} 
                                        {{valor}} {{unidad}} 
                                  {{/if}}</h5>
            <br>
            <br>
            <a class="btn-flat btn-small white"><i class="material-icons"></i></a>
            <a class="btn-flat btn-small white"><i class="material-icons"></i></a>
           
          </div>
        </div>

{{/if}}

       {{/each}}      
       

        
      <!--/div-->

    </div>
    <br><br>

    
      </div>

    </div>

  
  </div>


  <style type="text/css">
    
    .switch label input[type="checkbox"]:checked + .lever, .switch label input[type="checkbox"]:checked + .lever::after {
        background-color: #ff9800 !important
    }
  </style>
  
</template>

<template name="configuracion">

<div class="row">
      <div class="col s12 m2">
        <ul id="nav-mobile" class="sidenav sidenav-fixed" style="transform: translateX(0px);">
      
        <li class="no-padding">
          <ul class="collapsible collapsible-accordion">
           

                <li class="bold config" ><a class="collapsible-header waves-effect waves-teal" tabindex="0" data-config="config-disp" href="/config/dispositivo">Dispositivos</a>
                </li>
                 <li class="bold config" ><a class="collapsible-header waves-effect waves-teal" tabindex="0" data-config="configpermiso" href="/config/permiso">Permisos</a>
                </li>
                 <li class="bold config" ><a class="collapsible-header waves-effect waves-teal" tabindex="0" data-config="config-auto" href="/config/auto">Automatizacion</a>
                </li>
                <li class="bold config" ><a class="collapsible-header waves-effect waves-teal" tabindex="0" data-config="config-aires" href="/config/aires">Aires</a>
                </li>
            
           
          </ul>
        </li>
       
      </ul>





      </div>
      <div class="col s12 m10">
        
          

  <div class="container">
    <div class="section">

      {{> Template.dynamic template=config_plate}}

        
    </div>
    <br><br>

    
      </div>

    </div>

  
  </div>



</template>

<template name="configdisp">

  <div class="row">
    <div class="col s4 l2">
      <a class="btn-floating btn-large waves-effect waves-light orange modal-trigger pulse tooltipped" data-position="bottom" data-tooltip="Presione para agregar un nuevo dispositivo" href="#modal_agregar_dispositivo"><i class="material-icons">add</i></a>   
      <a class="modal-trigger" href="#modal_editar_dispositivo" id="boton_modal_editar" hidden ></a>
    </div>
    <DIV CLASS="col s8 l10">
        <h5>Agregar Dispositivo</h5>   
    </DIV>
  </div>

  <div class="divider"></div>
  <br>

  <h5>Lista de dispositivos</h5>
  <br>
   
   
  




  <ul class="collapsible">

    {{#each zona in zonas}}
    <li class="zonaconfig">
      <div class="collapsible-header"><i class="material-icons">blur_on</i><b>{{zona._id}}</b></div>
      <div class="collapsible-body">
        


              <ul class="collection">
                {{#each disp in dispositivos}}
                  {{#if equals disp.zona zona._id}}

                    <li class="collection-item avatar" id="configdisp_{{disp._id}}" data-pin="{{disp.pin}}" style="padding-bottom: 30px;">
                      <i class="material-icons circle" style="left:0px;" >{{disp.icono}}</i>
                      <span class="title" style="left:-5px;"><b>{{disp.nombre}}</b></span>
                       <p><b>Tipo:</b> {{disp.tipo}} <br>
                        <b>especifico:</b> {{disp.especifico}} <br>
                       {{#if equals disp.tipo "actuador"}}
                          <b>Estado actual:</b> {{disp.estado}} <br>
                         

                        
                        {{else}}
                          <b>Valor actual:</b> {{disp.valor}} <br>
                          <b>Unidad:</b> {{disp.unidad}}<br>
                        
                        {{/if}}
                           <b>Pin:</b> {{disp.pin}} <br>
                          </p>

                      <p>
                      <a href="#" class=" editar right"><i class="material-icons" style="color:#ff9800" data-id="{{disp._id}}">mode_edit</i></a>
                      <a href="#!" class=" eliminar right" style="top:54px; right:16px; color:#ff9800" ><i class="material-icons" data-id="{{disp._id}}">delete</i></a>
                      </p>
                    </li>
                  {{/if}}
                {{/each}}
                
              </ul>
                        




      </div>
    </li>

    {{/each}}
    
  </ul>
        

<!-- MODAL DE AGREGAR DISPOSITIVOS -->


  <div id="modal_agregar_dispositivo" class="modal" style="max-height: 80%">
    <div class="modal-content">
      
      <h4>Agregar Dispositivo</h4>
         <form class="col s12 new-disp" id="new-disp">
            <div class="row">
              <div class="input-field col s12">
              
                <input type="text" name="nombre" class="validate" id="nombre" required="true" />
                <label class="light-blue-text " for="nombre">Nombre</label>
              </div>

                <div class="col s12">
                  <label  class="light-blue-text">Tipo de Dispositivo</label>
                  <div class="row">
                    <div class=" col s6">
                        <p>
                          <input id="sensor" name="tipo" type="radio" value="sensor" required="true"/>   
                          <label for="sensor">Sensor</label>
                        </p>
                      </div>
                      <div class=" col s6">
                        <p>
                          <input id="actuador" name="tipo" type="radio" value="actuador" required="true"/>   
                          <label  for="actuador">Actuador</label>
                        </p>
                     </div>
                   </div>
                </div>

              <div class="input-field col s12">
                
                    <select class="icons" name="especifico" id="especifico">
                      <option value="" disabled selected>Seleccione un tipo especifico</option>
                      <!--option value="ldr" >ldr</option>
                      <option value="dht" >dht</option>
                      <option value="led" >led</option>
                      <option value="act" >actuador</option>
                      <option value="air" >air</option>
                      <option value="" data-icon="/images/.png"></option-->

                            <!--select class="icons" name="especifico" id="especifico">
                           <option value="" disabled selected>Seleccione un tipo especifico</option-->
                            {{#each tipodispos }}
                           
                              <option value="{{valor}}" >{{valor}}</option>
                                
                        {{/each}}
                               

                    </select>
                    <label class="light-blue-text ">Tipo específico</label>
                  
                  </div>

                  <div class="input-field col s12">
                
                    <select class="icons" name="icono" id="icono">
                      <option value="" disabled selected>Seleccione un ícono</option>
                      <option  class="light-blue-text" value="ac_unit" data-icon="/images/ac_unit.png"  >ac_unit</option>
                      <option value="power_settings" data-icon="/images/power_settings.png">power_settings</option>
                      <option value="beach_access" data-icon="/images/beach_access.png">beach_access</option>
                      <option value="camera" data-icon="/images/camera.png">camera</option>
                      <option value="cloud" data-icon="/images/cloud.png">cloud</option>
                      <option value="flare" data-icon="/images/flare.png">flare</option>
                      <option value="invert_colors" data-icon="/images/invert_colors.png">invert_colors</option>
                      <option value="directions_car" data-icon="/images/directions_car.png">directions_car</option>
                      <option value="power" data-icon="/images/power.png">power</option>
                      <option value="remove_red_eye" data-icon="/images/remove_red_eye.png">remove_red_eye</option>
                      <option value="security" data-icon="/images/security.png">security</option>
                      <option value="toys" data-icon="/images/toys.png">toys</option>
                      <option value="lock" data-icon="/images/lock.png">lock</option>
                      <option value="brightness_low" data-icon="/images/brightness_low.png">brightness_low</option>
                      <option value="whatshot" data-icon="/images/whatshot.png">whatshot</option>
                      <!--option value="" data-icon="/images/.png"></option-->
                     

                    </select>
                    <label class="light-blue-text ">Ícono</label>
                  
                  </div>
                    
            

                
               
               
                   <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="text" id="zona" class="autocomplete" name="zona" required="true">
                          <label  class="light-blue-text " for="zona">Zona</label>
                        </div>
                      </div>
                    </div>

                    <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">

                          <input type="text" id="pin" class="validate" name="pin" required="true">
                          <label  class="light-blue-text" data-error="Pin ocupado" for="pin" id="pin_label">Pin</label>
                          
                        </div>
                      </div>
                    </div>
                   
                       

            </div>



        </form>


    </div>
    <div class="modal-footer">
       <button class="btn waves-effect waves-light light-blue lighten-1" type="submit" name="action" form="new-disp">Guardar
                      <i class="material-icons right">send</i>
        </button>
        <br>
        <br>
        <br>
    </div>
  </div>

    <!-- FIN MODAL AGREGAR DISPOSITIIVOS -->

                <!-- MODAL EDITAR DISPOSITIVOS -->



                <div id="modal_editar_dispositivo" class="modal" style="max-height: 80%">
    <div class="modal-content">
      
      <h4>Editar Dispositivo</h4>
         <form class="col s12 edit-disp" id="edit-disp">
            <div class="row">
              <div class="input-field col s12">
              
                <input type="text" name="nombre" class="validate" id="edit_nombre" required="true" />
                <label class="light-blue-text " for="edit_nombre">Nombre</label>
              </div>

                <div class="col s12">
                  <label  class="light-blue-text">Tipo de Dispositivo</label>
                  <div class="row">
                    <div class=" col s6">
                        <p>
                          <input id="edit_sensor" name="tipo" type="radio" value="sensor" required="true"/>   
                          <label for="edit_sensor">Sensor</label>
                        </p>
                      </div>
                      <div class=" col s6">
                        <p>
                          <input id="edit_actuador" name="tipo" type="radio" value="actuador" required="true"/>   
                          <label  for="edit_actuador">Actuador</label>
                        </p>
                     </div>
                   </div>
                </div>

             

                  <div class="input-field col s12">
                
                    <select class="icons" name="icono" id="edit_icono">
                      <option value="" disabled selected>Seleccione un ícono</option>
                      <option  class="light-blue-text" value="ac_unit" data-icon="/images/ac_unit.png"  >ac_unit</option>
                      <option value="power_settings" data-icon="/images/power_settings.png">power_settings</option>
                      <option value="beach_access" data-icon="/images/beach_access.png">beach_access</option>
                      <option value="camera" data-icon="/images/camera.png">camera</option>
                      <option value="cloud" data-icon="/images/cloud.png">cloud</option>
                      <option value="flare" data-icon="/images/flare.png">flare</option>
                      <option value="invert_colors" data-icon="/images/invert_colors.png">invert_colors</option>
                      <option value="directions_car" data-icon="/images/directions_car.png">directions_car</option>
                      <option value="power" data-icon="/images/power.png">power</option>
                      <option value="remove_red_eye" data-icon="/images/remove_red_eye.png">remove_red_eye</option>
                      <option value="security" data-icon="/images/security.png">security</option>
                      <option value="toys" data-icon="/images/toys.png">toys</option>
                      <option value="lock" data-icon="/images/lock.png">lock</option>
                      <option value="brightness_low" data-icon="/images/brightness_low.png">brightness_low</option>
                      <option value="whatshot" data-icon="/images/whatshot.png">whatshot</option>
                      <!--option value="" data-icon="/images/.png"></option-->
                     

                    </select>
                    <label class="light-blue-text ">Ícono</label>
                  
                  </div>
                    
            

                
               
               
                   <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="text" id="edit_zona" class="autocomplete" name="zona" required="true">
                          <label  class="light-blue-text " for="edit_zona">Zona</label>
                        </div>
                      </div>
                    </div>

                    <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          <input type="text" name="id" hidden id="edit_id">
                          
                          <input type="text" id="edit_pin" class="autocomplete" name="pin" required="true">
                          <label  class="light-blue-text " for="pin">Pin</label>
                        </div>
                      </div>
                    </div>
                   
                       

            </div>



        </form>


    </div>
    <div class="modal-footer">
       <button class="btn waves-effect waves-light light-blue lighten-1" type="submit" name="action" form="edit-disp">Actualizar
                      <i class="material-icons right">send</i>
        </button>
        <br>
        <br>
        <br>
    </div>
  </div>
                  

                <!-- FIN MODAL EDITAR DISPOSITIVOS -->


  
</template>

<template name="configpermiso">
  <h2>Permisos</h2>

  {{#each user in users}}
  <div class="row">
    {{#each email in user.emails}}
     <h5>{{email.address}}</h5>

           <div class=" col s12">
          <p>
            {{#if admin user._id }}
              <input id="admin_{{user._id}}" name="admin_{{user._id}}" type="checkbox" class="filled-in admin" data-id="{{user._id}}" checked />
            {{else}}
              <input id="admin_{{user._id}}" name="admin_{{user._id}}" type="checkbox" class="filled-in admin" data-id="{{user._id}}" />
            {{/if}}   
            <label for="admin_{{user._id}}">Administrador</label>
          </p>
        </div>        



        {{#each zona in zonas}}
        <div class=" col s4">
          <p>
            {{#if permiso user._id zona._id}}
              <input id="permiso_{{zona._id}}_{{user._id}}" name="permiso_{{zona._id}}" type="checkbox" class="filled-in permiso" data-id="{{user._id}}" checked />
            {{else}}
              <input id="permiso_{{zona._id}}_{{user._id}}" name="permiso_{{zona._id}}" type="checkbox" class="filled-in permiso" data-id="{{user._id}}" />
            {{/if}}   
            <label for="permiso_{{zona._id}}_{{user._id}}">{{zona._id}}</label>
          </p>
        </div>
       {{/each}}
    {{/each}}
  </div>
<div class="divider"></div>
  {{/each}}  


 
   
</template>





<!-- CONFIGURACION AUTOMATICA -->
<template name="configauto">
 
  <div class="row">
    <div class="col s4 l2">
      <a class="btn-floating btn-large waves-effect waves-light orange modal-trigger pulse tooltipped" data-position="bottom" data-tooltip="Presione para agregar un nuevo dispositivo" href="#modal_agregar_auto"><i class="material-icons">add</i></a>   
      <a class="modal-trigger" href="#modal_editar_auto" id="boton_modal_editar_auto" hidden ></a>
    </div>
    <DIV CLASS="col s8 l10">
        <h5>Crear rutinas</h5>   
    </DIV>
  </div>
  <div class="divider"></div>
  <br>

  <h5>Lista de rutinas</h5>
  <br>
                        

    <ul class="collapsible">

    
    {{#each rutina in rutinas}}
    <li class="listaauto" id="auto_{{rutina._id}}">
     
      <div class="collapsible-header"><i class="material-icons {{estatus rutina.estatus}} accent-4">alarm_on</i><b>{{rutina.nombre}}</b></div>
     

      <div class="collapsible-body">
        


              <ul class="collection">

                <div class="switch center">
                    <p>Estatus</p>
                    <label>
                      Inactiva
                      {{# if equals rutina.estatus "inactiva"}}
                      <input type="checkbox" data-id={{rutina._id}}  class="switch cambio-estatus" >
                      
                      {{else}}
                      <input type="checkbox" data-id={{rutina._id}} checked class="switch cambio-estatus">
                      
                      {{/if}}
                      <span class="lever"></span>
                      Activa
                    </label>
                  </div>

                          <li class="collection-item">
                             
                          </li>
                
                           <li class="collection-item">
                            <b>Frecuencia</b>
                            <p>{{espacio rutina.frecuencia}} </p>
                         
                          </li>

                           <li class="collection-item">
                            <b>Hora</b>
                            <p>Encendido: {{ hora rutina.hora_encendido}}</p>
                            <p>Apagado: {{hora rutina.hora_apagado}}</p>
                         
                          </li>

                          <!--li class="collection-item">
                            <b>Fecha</b>
                            <p>Inicio: {{fecha rutina.fecha_inicio}}</p>
                            <p>Fin: {{ fecha rutina.fecha_fin}}</p>
                         
                          </li-->
                    
                        
                       <!--
                        -->
                          {{#each dsp in dispositivos}}
                            {{#each dispositivo in rutina.dispositivos}}
                                {{#if equals dsp._id dispositivo }}
                            
                         <li class="collection-item">
                          <b>Dispositivos</b> <br><br>
                            <i class="material-icons" style="margin-right: 10px;">{{dsp.icono}}</i> <b> {{dsp.nombre}} /  {{dsp.zona}} </b> </li> 
                              {{/if}}
                            {{/each}}
                        {{/each}}
                            
                        
                          <li class="collection-item">    
                          
                      <p>
                      <a href="#" class=" editar_auto right"><i class="material-icons" style="color:#ff9800" data-id="{{rutina._id}}">mode_edit</i></a>
                      <a href="#!" class=" eliminar_auto right" style="top:54px; right:16px; color:#ff9800" ><i class="material-icons" data-id="{{rutina._id}}">delete</i></a>
                      </p>
                    </li>
                 
              
                
              </ul>
                        




      </div>
    </li>
    {{/each}}



    




   
    
  </ul>
  



<!-- MODAL DE AGREGAR RUTINAS -->


  <div id="modal_agregar_auto" class="modal" style="max-height: 80%">
    <div class="modal-content">
      
      <h4>Crear Rutinas</h4>
         <form class="col s12 new-auto" id="new-auto">
            <div class="row">
              <div class="input-field col s12">
              
                <input type="text" name="nombre" class="validate" id="nombre_rutina"  />
                <label class="light-blue-text " for="nombre">Nombre</label>
              </div>              
               
                   <!--div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="date" id="fecha_inicio" class="datepicker " name="fecha_inicio"  >
                          <label  class="light-blue-text active" for="fecha_inicio">Fecha Inicio</label>
                        </div>
                      </div>
                    </div>

                     <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="date" id="fecha_fin" class="datepicker" name="fecha_fin" >
                          <label  class="light-blue-text active" for="fecha_fin">Fecha Fin</label>
                        </div>
                      </div>
                    </div-->

                    <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="time" id="hora_inicio" class="timepicker" name="hora_encendido" >
                          <label  class="light-blue-text active" for="hora_encendido">Hora Encendido</label>
                        </div>
                      </div>
                    </div>

                    <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="time" id="hora_fin" class="timepicker" name="hora_apagado" >
                          <label  class="light-blue-text active" for="hora_apagado">Hora Apagado</label>
                        </div>
                      </div>
                    </div>

                     <div class="col s12">
                      
                       
                          
                           <label  class="light-blue-text active">Frecuencia</label>
                           <br>
                           <br>
                           <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="lunes" value="1" id="lunes" />
                          <label for="lunes">lun</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="martes" value="2" id="martes"/>
                          <label for="martes">mar</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="miercoles" value="3" id="miercoles"/>
                          <label for="miercoles">mie</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="jueves" value="4" id="jueves"/>
                          <label for="jueves">jue</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="viernes" value="5" id="viernes"/>
                          <label for="viernes">vie</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="sabado" value="6" id="sabado"/>
                          <label for="sabado">sab</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="domingo" value="7" id="domingo"/>
                          <label for="domingo">dom</label>
                          </div>


                        
                     
                    </div>
                   
                   
                   <div class="col s12" style="margin-top: 35px;">
                    <label  class="light-blue-text active">Seleccione los dispositivos a controlar</label>
                    <ul class="collapsible">
                       {{#each zona in zonas}}
                        <li class="zonaconfig">
                          <div class="collapsible-header"><i class="material-icons">alarm</i><b>{{zona._id}}</b></div>
                          <div class="collapsible-body">
                            


                                  <ul class="collection">
                                    {{#each disp in dispositivos}}
                                      {{#if equals disp.zona zona._id}}
                                        <div class="col s3">
                                          <input type="checkbox" class="filled-in dispositivo_auto" name="{{disp._id}}" id="{{disp.nombre}}_{{disp.zona}}"/>
                                          <label for="{{disp.nombre}}_{{disp.zona}}">{{disp.nombre}} <i class="material-icons circle" >{{disp.icono}}</i></label>
                                        </div>
                                      {{/if}}
                                    {{/each}}
                                    
                                  </ul>
                                            




                          </div>
                        </li>

                        {{/each}}    
                    </ul>        
                  </div>
                 
                       

            </div>



        </form>


    </div>
    <div class="modal-footer">
       <button class="btn waves-effect waves-light light-blue lighten-1" type="submit" name="action" form="new-auto">Guardar
                      <i class="material-icons right">send</i>
        </button>
        <br>
        <br>
        <br>
    </div>
  </div>

    <!-- FIN MODAL AGREGAR RUTINAS -->


<!-- MODAL DE EDITAR RUTINAS -->


  <div id="modal_editar_auto" class="modal" style="max-height: 80%">
    <div class="modal-content">
      
      <h4>Editar Rutinas</h4>
         <form class="col s12 edit-auto" id="edit-auto">
            <div class="row">
              <div class="input-field col s12">
                
                <input type="text" name="nombre" class="validate" id="edit_nombre_rutina"  />
                <label class="light-blue-text " for="edit_nombre_rutina">Nombre</label>
              </div>              
               
                   <!--div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="date" id="edit_fecha_inicio" class="datepicker " name="fecha_inicio"  >
                          <label  class="light-blue-text active" for="edit_fecha_inicio">Fecha Inicio</label>
                        </div>
                      </div>
                    </div>

                     <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="date" id="edit_fecha_fin" class="datepicker" name="fecha_fin" dateformat="d M y" >
                          <label  class="light-blue-text active" for="edit_fecha_fin">Fecha Fin</label>
                        </div>
                      </div>
                    </div-->

                    <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="time" id="edit_hora_encendido" class="timepicker" name="hora_encendido" >
                          <label  class="light-blue-text active" for="edit_hora_encendido">Hora Encendido</label>
                        </div>
                      </div>
                    </div>

                    <div class="col s12">
                      <div class="row">
                        <div class="input-field col s12">
                          
                          <input type="time" id="edit_hora_apagado" class="timepicker" name="hora_apagado" >
                          <label  class="light-blue-text active" for="edit_hora_apagado">Hora Apagado</label>
                        </div>
                      </div>
                    </div>

                     <div class="col s12">
                      
                       
                          
                           <label  class="light-blue-text active">Frecuencia</label>
                           <br>
                           <br>
                           <div class="col s5 l2" >
                            
                           


                          <input type="checkbox" class="filled-in dia" name="lunes" value="1" id="edit_lunes" />
                          <label for="edit_lunes">lun</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="martes" value="2" id="edit_martes"/>
                          <label for="edit_martes">mar</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="miercoles" value="3" id="edit_miercoles"/>
                          <label for="edit_miercoles">mie</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="jueves" value="4" id="edit_jueves"/>
                          <label for="edit_jueves">jue</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="viernes" value="5" id="edit_viernes"/>
                          <label for="edit_viernes">vie</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="sabado" value="6" id="edit_sabado"/>
                          <label for="edit_sabado">sab</label>
                          </div>
                          <div class="col s5 l2" >
                          <input type="checkbox" class="filled-in dia" name="domingo" value="7" id="edit_domingo"/>
                          <label for="edit_domingo">dom</label>


                             
                          </div>


                        
                     
                    </div>
                   
                   
                   <div class="col s12" style="margin-top: 35px;">
                    <label  class="light-blue-text active">Seleccione los dispositivos a controlar</label>
                    <ul class="collapsible">
                       {{#each zona in zonas}}
                        <li class="zonaconfig">
                          <div class="collapsible-header"><i class="material-icons">alarm</i><b>{{zona._id}}</b></div>
                          <div class="collapsible-body">
                            


                                  <ul class="collection">
                                    {{#each disp in dispositivos}}
                                      {{#if equals disp.zona zona._id}}
                                        <div class="col s3">
                                             {{#if disp_auto_check disp._id}}
                                                <input type="checkbox" class="filled-in dispositivo_auto" name="{{disp._id}}" id="edit_{{disp.nombre}}_{{disp.zona}}" checked />
                                              {{else}}
                                                <input type="checkbox" class="filled-in dispositivo_auto" name="{{disp._id}}" id="edit_{{disp.nombre}}_{{disp.zona}}"/>
                                              {{/if}}
                                          <label for="edit_{{disp.nombre}}_{{disp.zona}}">{{disp.nombre}} <i class="material-icons circle" >{{disp.icono}}</i></label>
                                        </div>
                                      {{/if}}
                                    {{/each}}
                                    
                                  </ul>
                                            




                          </div>
                        </li>

                        {{/each}}    
                    </ul>        
                  </div>
                 
                       

            </div>



        </form>


    </div>
    <div class="modal-footer">
       <button class="btn waves-effect waves-light light-blue lighten-1" type="submit" name="action" form="edit-auto">Guardar
                      <i class="material-icons right">send</i>
        </button>
        <br>
        <br>
        <br>
    </div>
  </div>

    <!-- FIN MODAL EDITAR RUTINAS -->







<script type="text/javascript">
  $(document).ready(function(){
    $('.datepicker').datepicker();
  });
</script>

       
</template>




<template name="configaires">
  <h4>Configuracion Aires</h4>

   
  <br>
                        

    <ul class="collapsible">

    
    {{#each aires}}
    <li class="listaauto" >
     
      <div class="collapsible-header"><i class="material-icons accent-4">{{icono}}</i><b>{{zona}} / {{nombre}}</b></div>
     

      <div class="collapsible-body">
        


              <ul class="collection">

                <div class="switch center">
                    <p>Estatus</p>
                    <label>
                      Inactiva
                      {{# if equals controltemp.estatus "off"}}
                      <input type="checkbox" data-id={{_id}}  class="switch controltemp-estatus" >
                      
                      {{else}}
                      <input type="checkbox" data-id={{_id}} checked class="switch controltemp-estatus">
                      
                      {{/if}}
                      <span class="lever"></span>
                      Activa
                    </label>
                  </div>

                          <li class="collection-item">
                             
                          </li>
                
                           <li class="collection-item center">
                            <b>Temperatura</b>
                            <p>
                              <a class="btn-floating btn-small waves-effect waves-light light-blue"><i class="material-icons cambiar" data-id="{{_id}}" data-accion="bajar">remove</i></a>
                              {{controltemp.temperatura}}
                              <a class="btn-floating btn-small waves-effect waves-light light-blue" ><i class="material-icons cambiar" data-id="{{_id}}" data-accion="subir">add</i></a> 
                            </p>
                         
                          </li>

                            
                        
                          
                 
              
                
              </ul>
                        




      </div>
    </li>

    {{/each}}
    
    



    




   
    
  </ul>

  


<script type="text/javascript">
  $(document).ready(function(){
    $('.collapsible').collapsible();
  });
</script>

<style type="text/css">
  .tabs .indicator{
    background-color:#03a9f4;
  }
</style>
 
   
</template>


<!--   FIN CONFIGURACION AUTOMATICA   -->

<template name="email">
  
   <h5>{{this.emails.address}}</h5>
      {{#each zonas}}
      <div class=" col s4">
        <p>
          <input id="permiso_{{_id}}" name="permiso_{{_id}}" type="checkbox" class="filled-in" />   
          <label for="permiso_{{_id}}">{{_id}}</label>
        </p>
      </div>
     {{/each}}

  
  
       
</template>

<template name="general">
  <div class="row">
    <div class="col s12 m2">     
      <ul id="nav-mobile" class="sidenav sidenav-fixed" style="transform: translateX(0px);">
        <li class="no-padding">
          <ul class="collapsible collapsible-accordion">            
            <li class="bold zona" >
              <a class="collapsible-header waves-effect waves-teal truncate" tabindex="0" href="/general/eventos">Eventos</a>
            </li>
            <li class="bold zona" >
              <a class="collapsible-header waves-effect waves-teal truncate" tabindex="0" href="/general/humedad">Humedad</a>
            </li>           
          </ul>
        </li>
      </ul>
    </div>

     <div class="col s12 m10">
        
          

  <div class="container">
    <div class="section">

      {{> Template.dynamic template=general_plate}}

        
    </div>
    <br><br>

    
      </div>

    </div>



  </div>

</template>

<template name="geneventos">

  <h5 class="center-align"> EVENTOS GENERAL</h5>







            



{{#if eventos.count}}
<table class="centered highlight responsive-table">
        <thead>
          <tr>
              <th>Tipo de Evento</th>              
              <th>Zona</th>
              <th>Fecha</th>
                          
              

          </tr>
        </thead>

        <tbody>
  {{#each evento in eventos}}
    {{#each e in evento.fecha}}
      
          <tr>
            <td>{{evento.tipo}}</td>
            <td>{{evento.zona}}</td>
            <td>{{fecha_formato e.fecha}}</td>
          </tr>
          
       
  
    {{/each}}
  {{/each}}
   </tbody>
      </table>
  {{else}}
    <p>No hay Eventos Registrados</p>
  {{/if}}
  
</template>

<template name="genhumedad">

    <DIV class="col s12">
    <h5 class="center-align"> HUMEDAD GENERAL</h5>

    {{#if humedad.count}}

    <!-- REVISAR ESTA TABLA -->

      <table class="centered highlight responsive-table">
        <thead>
          <tr>
              <th>Nombre Sensor</th>              
              <th>Avg Total</th>
              <th>Avg Hoy</th>
              <th>Avg Semanal</th>
              <th>Avg Mensual</th>
              <th>Avg Anual</th>
              
              

          </tr>
        </thead>
         <tbody>

     {{#each hum in humedad}}
         
          

       
          <tr>
            <td>{{hum.nombre}} / {{hum.zona}} </td>
            <td>{{redondear hum.avg_total}}</td>
            <td>{{redondear hum.avg_hoy}}</td>
            <td>{{redondear hum.avg_semana}}</td>
            <td>{{redondear hum.avg_mes}}</td>
            <td>{{redondear hum.avg_anno}}</td>
          </tr>
          
        
      
        
      {{/each}}
      </tbody>
      </table>
    {{else}}
    <p>No hay Datos Registrados</p>
  {{/if}}

  </DIV>
</template>


<template name="registro">
  
  <div id="registro">
   {{#if estado}}
      <h2 class="center">Su cuenta de Telegram ha sido registrada, ahora recibirá alertas por allí</h2>
   {{else}}
      <h2 class="center">Enlace no válido</h2>
   {{/if}}

   
  </div>

</template>



<template name="file">
<!--script>

(function ($) {

    var methods = {
        _download: function (options) {
            var triggerDelay = (options && options.delay) || 100;
            var cleaningDelay = (options && options.cleaningDelay) || 1000;

            this.each(function (index, item) {
                methods._createIFrame(item, index * triggerDelay, cleaningDelay);
            });
            return this;
        },

        _createIFrame: function (item, triggerDelay, cleaningDelay) {
            setTimeout(function () {
                var frame = $('<iframe style="display: none;" class="multi-download-frame"></iframe>');
                frame.attr('src', $(item).attr('href') || $(item).attr('src'));
                $(item).after(frame);
                setTimeout(function () { frame.remove(); }, cleaningDelay);
            }, triggerDelay);
        }
    };

    $.fn.multiDownload = function(options) {
        return methods._download.apply(this, arguments);
    };

})(jQuery);







  $('#download-all').click(function (event) {

  event.preventDefault();

  $('.my-file').multiDownload({ delay: 3000 }); // Download with delay (3s)
  });

  </script-->

  <a href="/files/file.pdf" class="my-file" download id="file_download">file download</a>
  <a href="/files/guia.pdf" class="my-file" download id="file_download_1">file download</a>
  <a href="#" id="download-all">Download All</a>
</template>